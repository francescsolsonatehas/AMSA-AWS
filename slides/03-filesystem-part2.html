<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Jordi Mateo Fornés">
  <title>AMSA - Fall 2025 – Sistema de fitxers (II)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="styles.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Sistema de fitxers (II)</h1>
  <p class="subtitle">Unitat 3 · Administració i Manteniment de Sistemes i Aplicacions (AMSA)</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jordi Mateo Fornés 
</div>
</div>
</div>

</section>
<section>
<section id="introducció-als-raids" class="title-slide slide level1 center">
<h1>Introducció als RAIDs</h1>

</section>
<section id="què-és-un-raid" class="slide level2">
<h2>Què és un RAID?</h2>
<p>Un <strong>RAID</strong> (<em>Redundant Array of Independent (originalment Inexpensive) Disks</em>) és un conjunt de dispositius d’emmagatzematge que es combinen per a formar un sistema d’emmagatzematge únic. Aquest nou sistema d’emmagatzematge permet distribuir les dades entre els diferents dispositius que el formen i millorar-ne mètriques com la <strong>redundància</strong> o el <strong>rendiment</strong>.</p>
<aside class="notes">
<ul>
<li>Els RAIDs són un conjunt de dispositius d’emmagatzematge que es combinen per a formar un sistema d’emmagatzematge únic.</li>
<li>El principal objectiu d’aquesta combinació és tolerar les fallades que es poden produir en els dispositius d’emmagatzematge. Aquesta redundància es pot aconseguir mitjançant la <strong>duplicació</strong> de les dades o mitjançant la <strong>paritat</strong>, com veurem més endavant.</li>
<li>Un altre objectiu important dels RAIDs és millorar el rendiment del sistema mitjançant la <strong>distribució</strong> de les dades entre els diferents dispositius. Això permet millorar la velocitat de lectura i escriptura de les dades. Es coneix també com <strong>striping</strong> o en altres paraules ens permet incrementar la <strong>ample de banda</strong>.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="què-és-el-rendiment-i-la-redundància" class="slide level2">
<h2>Què és el rendiment i la redundància?</h2>
<ul>
<li class="fragment"><p>La <strong>redundància</strong> és la capacitat d’un sistema de continuar funcionant en cas de fallada d’un o més dispositius. Aquesta capacitat es pot aconseguir mitjançant la <strong>duplicació</strong> de les dades o mitjançant la <strong>paritat</strong>.</p></li>
<li class="fragment"><p>El <strong>rendiment</strong> és la capacitat d’un sistema de processar un volum de dades en un temps determinat. Aquesta capacitat es pot aconseguir mitjançant la <strong>distribució</strong> de les dades entre els diferents dispositius, mitjançant una tècnica coneguda com <strong>striping</strong>.</p></li>
</ul>
</section>
<section id="conceptes-bàsics" class="slide level2 smaller">
<h2>Conceptes bàsics</h2>
<ul>
<li class="fragment"><strong>Redundància</strong>: Capacitat de tolerar fallades de dispositiu (<em>quantitat de discs que poden fallar sense perdre dades</em>).</li>
<li class="fragment"><strong>Rendiment</strong>: Mesurat en <em>IOPS</em> i ample de banda <em>MB/s</em>. Depèn de la <em>mida de stripe</em>,<em>nombre de discs</em> i <em>patró d’accés (seqüencial vs aleatori)</em>.</li>
<li class="fragment"><strong>Capacitat</strong>: La capacitat total del sistema és la suma de les capacitats dels dispositius que el formen, tenint en compte la redundància.</li>
<li class="fragment"><strong>Stripe</strong>: Un stripe és una unitat d’informació que es distribueix entre els diferents dispositius que formen el RAID. Conjunt de blocs distribuïts entre discs dins del RAID.</li>
<li class="fragment"><strong>Bloc</strong>: Un bloc és una unitat d’informació que es llegeix o s’escriu en un dispositiu d’emmagatzematge. (<strong>512B, 4KB…</strong>).</li>
</ul>
<div class="fragment" title="Diferència entre Stripe i Bloc">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Diferència entre Stripe i Bloc</strong></p>
</div>
<div class="callout-content">
<p>Amb 2 dispositius i un stripe de 64 KB, cada dispositiu guarda 64 KB alternatius d’un fitxer.</p>
</div>
</div>
</div>
</div>
</section>
<section id="implementacions-de-raids" class="slide level2 smaller">
<h2>Implementacions de RAIDs</h2>
<ul>
<li class="fragment"><strong>Software RAID</strong>: Implementat a nivell de sistema operatiu.
<ul>
<li class="fragment"><strong>Avantatges</strong>: flexibilitat, transparència, no depèn del hardware.</li>
<li class="fragment"><strong>Inconvenients</strong>: CPU utilitzat per càlculs de paritat.</li>
</ul></li>
<li class="fragment"><strong>Hardware RAID</strong>: Controladora dedicada (característiques pròpies, cache, acceleració XOR).
<ul>
<li class="fragment"><strong>Avantatges</strong>: millors rendiments en alguns escenaris;</li>
<li class="fragment"><strong>Inconvenients</strong>: dependència del controlador, propietat de metadades.</li>
</ul></li>
<li class="fragment"><strong>Fake/BIOS RAID</strong>: Solució mixta (<em>controladora amb firmware mínim</em>). Pot generar problemes de portabilitat i compatibilitat.</li>
</ul>
</section>
<section id="implementacions-de-raids-1" class="slide level2">
<h2>Implementacions de RAIDs</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="../figs/slides/03-raids/SWRAID.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="../figs/slides/03-raids/HWRAID.png"></p>
</div></div>
</section>
<section id="raid-lineal" class="slide level2 smaller">
<h2>RAID Lineal</h2>
<div class="center-container">
<p><code>cat</code> lògic entre diversos dispositius d’emmagatzematge físics. <strong>JBOD</strong> (Just a Bunch Of Disks). No millora ni la redundància ni el rendiment.</p>
</div>
<div class="center-container">
<p><img data-src="../figs/slides/03-raids/LINEAR.png"></p>
</div>
<aside class="notes">
<ul>
<li><p>El RAID lineal és el més bàsic de tots els tipus de RAID.</p></li>
<li><p>En aquest sistema, la informació es distribueix primer en un disc i després en l’altre, seguint un ordre seqüencial. Cada unitat d’informació es coneguda com a <strong>stripe</strong>, i correspon a un bloc.</p></li>
<li><p>La figura mostra un exemple de RAID Lineal (/dev/md0) amb dos discos (/dev/vda i /dev/vdb). En aquest exemple s’han guardat els primers blocs (1 al 6) a la partició (/dev/vda1). Ara, s’ha d’assumir que la partició (/dev/sda1) es plena. Els següents blocs es guarden a la següent partició disponible (/dev/vdb1). I així successivament.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="raid-0-striping" class="slide level2 smaller">
<h2>RAID 0 (Striping)</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p><img data-src="../figs/slides/03-raids/RAID0.png"></p>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:40%;">
<ul>
<li class="fragment"><strong>Objectiu</strong>: augmentar rendiment i capacitat (<em>capacitat = suma de discos</em>).</li>
<li class="fragment"><strong>Mida de stripe</strong>:
<ul>
<li class="fragment">Petits milloren IOPS aleatoris.</li>
<li class="fragment">Grans stripes milloren seqüencials.</li>
</ul></li>
<li class="fragment">Si les dades són prou grans, es poden llegir/escriure en paral·lel.</li>
<li class="fragment"><strong>Tolerància a fallades</strong>: 0 (pèrdua total si un disc falla).</li>
<li class="fragment"><strong>Aplicacions</strong>: cache, fitxers temporals, tasques on la redundància no és prioritària.</li>
</ul>
</div></div>
<aside class="notes">
<ul>
<li>El nivell 0 de RAID és un dels més senzills i més utilitzats. El seu objectiu principal és millorar el rendiment del sistema mitjançant la <strong>distribució</strong> de les dades entre els diferents dispositius.</li>
<li>Aquesta distribució es realitza mitjançant una tècnica coneguda com <strong>striping</strong>. Aquesta tècnica permet dividir les dades en blocs més petits i distribuir-los entre els diferents dispositius. Fent Round Robin a tots els dispositius.</li>
<li>Això permet millorar la velocitat de lectura i escriptura de les dades, per tant incrementa l’<strong>ample de banda</strong>.</li>
<li>La capacitat del sistema també es veu incrementada, ja que la capacitat total del sistema és la suma de les capacitats dels dispositius que el formen.</li>
<li>El principal desavantatge del nivell 0 de RAID és que no ofereix cap tipus de redundància. Això vol dir que si un dels dispositius falla, es perden totes les dades del sistema.</li>
<li>La figura mostra un exemple de RAID0 (/dev/md0) amb dos discos (/dev/vda i /dev/vdb). En aquest exemple s’han guardat els primers blocs (1 al 6) de forma alternada 1 a cada disc. El següent bloc (9) es guarda al disc (/dev/vdb). En aquest exemple, els blocs parells es guarden al disc (/dev/vdb) i els senars al disc (/dev/vda).</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="raid-1-mirror" class="slide level2 smaller">
<h2>RAID 1 (Mirror)</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="../figs/slides/03-raids/RAID1.png"></p>
</div><div class="column" style="width:40%;">
<ul>
<li class="fragment"><strong>Objectiu</strong>: redundància via duplicació exacta (<strong>mirrors</strong>).</li>
<li class="fragment"><strong>Lectures</strong>: potencialment paral·leles (millora), depèn del controlador.</li>
<li class="fragment"><strong>Escriptures</strong>: es repliquen en tots els mirrors (overhead escritura).</li>
<li class="fragment"><strong>Capacitat usable</strong>: 50% amb 2 discos (<em>en general n/2 en conjunts de mirrors</em>).</li>
<li class="fragment"><strong>Aplicacions</strong>: sistema root, dades crítiques on la coherència immediata és prioritària.</li>
</ul>
</div></div>
<aside class="notes">
<ul>
<li>El nivell 1 té com a objectiu principal millorar la <strong>redundància</strong> del sistema mitjançant la <strong>duplicació</strong> de les dades en dos dispositius.</li>
<li>La figura 1.3 mostra un exemple de RAID1 (/dev/md0) amb dos discos (/dev/vda i /dev/vdb). En aquest exemple s’han guardat els primers blocs (1 al 6) de forma idèntica en els dos discos. Això significa que si un dels discos falla, l’altre disc pot continuar funcionant sense interrupció, ja que conté una còpia completa de totes les dades.</li>
<li>Per tant, el principal avantatge del nivell 1 de RAID és la redundància. Això vol dir que si un dels dispositius falla, es poden recuperar les dades sense problemes.</li>
<li>Un altre avantatge del nivell 1 de RAID és que permet realitzar lectures gairebé el doble de ràpides, ja que es poden llegir les dades de forma simultània des dels dos dispositius.</li>
<li>Per contra, el nivell 1 de RAID també té alguns desavantatges. El principal desavantatge és el cost, ja que es necessiten més dispositius per a duplicar les dades. Això vol dir que el cost del sistema es duplica. A més, l’escriptura és més lenta, ja que es necessita escriure les dades en els dos dispositius de forma simultània. Finalment, la capacitat del sistema també es veu reduïda, ja que només es pot utilitzar la meitat de la capacitat total dels dispositius.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="raid-2" class="slide level2 smaller">
<h2>RAID 2</h2>
<div class="center-container">
<p><img data-src="../figs/slides/03-raids/RAID2.png" style="width:60.0%"></p>
</div>
<ul>
<li class="fragment">El stripe és a nivell de <strong>bit</strong> i no de bloc com fins ara.</li>
<li class="fragment"><strong>Pràcticament obsolet</strong> en sistemes moderns: exigeix molts discs i accès sincronitzat.</li>
</ul>
<aside class="notes">
<ul>
<li><p>El nivell 2 de RAID utilitza la paritat per detectar i corregir errors en les dades. Aquesta paritat es calcula mitjançant bits de control anomenats <strong>bits de paritat</strong>.</p></li>
<li><p>Observem que el stripe és a nivell de bit i no de bloc com fins ara. Això vol dir que les dades es divideixen en bits més petits i es distribueixen entre els diferents dispositius.</p></li>
<li><p>La Figura 1.4 mostra un exemple d’una configuració RAID 2 que implementa un codi Hamming(4,3), és a dir, 4 bits de dades i 3 bits de paritat. Aquesta configuració pot semblar poc pràctica en molts contextos, però ens proporciona una comprensió clara de com funciona la codificació de les dades i, en particular, la codificació de Hamming.</p></li>
<li><p>Els codis Hamming són una classe de codis de correcció d’errors que es basen en la paritat. Aquests codis són molt útils per a la detecció i correcció d’errors en les dades, ja que permeten identificar i corregir errors en les dades sense necessitat de retransmissió.</p></li>
<li><p>El seu ús es poc pràctic en molts contextos, ja que requereix una gran quantitat de dispositius i afegeix la complexitat de la implementació de la codificació de Hamming <strong>(encoded)</strong>.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="codis-de-hamming" class="slide level2 smaller">
<h2>Codis de Hamming</h2>
<p>Els codis de Hamming són una classe de codis de <strong>correcció d’errors</strong> que es basen en la <em>paritat</em>. Aquests codis són molt útils per a la detecció i correcció d’errors en les dades, ja que permeten identificar i corregir errors en les dades sense necessitat de retransmissió.</p>
<ul>
<li class="fragment">El <strong>codi de Hamming</strong> permet <strong>detectar i corregir un sol error de bit</strong>.<br>
</li>
<li class="fragment">S’utilitza en el <strong>RAID 2</strong> per protegir dades a nivell de bit.</li>
<li class="fragment">S’intercalen bits de <strong>paritat</strong> entre els bits de <strong>dades</strong>.<br>
</li>
<li class="fragment">Cada bit de paritat comprova un conjunt específic de bits de dades.<br>
</li>
<li class="fragment">Si un bit es corromp, la combinació dels bits de paritat indica <strong>quin bit</strong> s’ha de corregir.</li>
</ul>
</section>
<section id="xor-operació-bàsica" class="slide level2 smaller">
<h2>XOR (Operació bàsica)</h2>
<p>La operació XOR (exclusive OR) és una operació lògica que compara dos bits i retorna un bit de resultat. El resultat és 1 si els bits comparats són diferents, i 0 si són iguals.</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th style="text-align: center;"><span class="math inline">\(A \oplus B\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</section>
<section id="hamming74---0110" class="slide level2 smaller">
<h2>Hamming(7,4) -&gt; [0110]</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td><span class="math inline">\(p_1\)</span></td>
<td><span class="math inline">\(p_2\)</span></td>
<td><span class="math inline">\(d_1\)</span></td>
<td><span class="math inline">\(p_3\)</span></td>
<td><span class="math inline">\(d_2\)</span></td>
<td><span class="math inline">\(d_3\)</span></td>
<td><span class="math inline">\(d_4\)</span></td>
</tr>
<tr class="even">
<td>Dades</td>
<td></td>
<td></td>
<td>0</td>
<td></td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(p_1\)</span></td>
<td><strong>1</strong></td>
<td></td>
<td>0</td>
<td></td>
<td>1</td>
<td></td>
<td>0</td>
</tr>
<tr class="even">
<td><span class="math inline">\(p_2\)</span></td>
<td></td>
<td><strong>1</strong></td>
<td>0</td>
<td></td>
<td></td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(p_3\)</span></td>
<td></td>
<td></td>
<td></td>
<td><strong>0</strong></td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>Codi</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<blockquote>

<ul>
<li class="fragment">Els bits que són potència de 2 (<span class="math inline">\(2^k\)</span>, k=0,1, 2…) són els bits de paritat.</li>
<li class="fragment">Bits de paritat = XOR bits de dades amb el <span class="math inline">\(n^o\)</span> de bit de paritat.</li>
</ul>

</blockquote>
<div class="center-container">
<p><strong>[0110]</strong> es codifica com <strong>[1100110]</strong></p>
</div>
</section>
<section id="comprovació-derrors-amb-hamming-1100110" class="slide level2 smaller">
<h2>Comprovació d’errors amb Hamming [1100110]</h2>
<ul>
<li class="fragment">Es calcula els bits de <strong>Comprovació</strong> = XOR del bits de paritat i de tots els seus bits de dades associats:</li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>p<span class="math inline">\(_1\)</span></td>
<td>p<span class="math inline">\(_2\)</span></td>
<td>d<span class="math inline">\(_1\)</span></td>
<td>p<span class="math inline">\(_3\)</span></td>
<td>d<span class="math inline">\(_2\)</span></td>
<td>d<span class="math inline">\(_3\)</span></td>
<td>d<span class="math inline">\(_4\)</span></td>
<td style="text-align: center;">Comprovació</td>
</tr>
<tr class="even">
<td>Codi</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>p<span class="math inline">\(_1\)</span></td>
<td>1</td>
<td></td>
<td>0</td>
<td></td>
<td>1</td>
<td></td>
<td>0</td>
<td style="text-align: center;"><strong>0</strong></td>
</tr>
<tr class="even">
<td>p<span class="math inline">\(_2\)</span></td>
<td></td>
<td>1</td>
<td>0</td>
<td></td>
<td></td>
<td>1</td>
<td>0</td>
<td style="text-align: center;"><strong>0</strong></td>
</tr>
<tr class="odd">
<td>p<span class="math inline">\(_3\)</span></td>
<td></td>
<td></td>
<td></td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align: center;"><strong>0</strong></td>
</tr>
</tbody>
</table>
<div class="center-container">
<p>Tots els <strong>bits de comprovació = 0</strong> → cap error detectat.</p>
</div>
</section>
<section id="comprovació-derrors-amb-hamming-1100111" class="slide level2 smaller">
<h2>Comprovació d’errors amb Hamming [1100111]</h2>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>p<span class="math inline">\(_1\)</span></td>
<td>p<span class="math inline">\(_2\)</span></td>
<td>d<span class="math inline">\(_1\)</span></td>
<td>p<span class="math inline">\(_3\)</span></td>
<td>d<span class="math inline">\(_2\)</span></td>
<td>d<span class="math inline">\(_3\)</span></td>
<td>d<span class="math inline">\(_4\)</span></td>
<td style="text-align: center;">Comprovació</td>
</tr>
<tr class="even">
<td>Codi</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td><strong>1</strong></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>p<span class="math inline">\(_1\)</span></td>
<td>1</td>
<td></td>
<td>0</td>
<td></td>
<td>1</td>
<td></td>
<td>1</td>
<td style="text-align: center;"><strong>1</strong></td>
</tr>
<tr class="even">
<td>p<span class="math inline">\(_2\)</span></td>
<td></td>
<td>1</td>
<td>0</td>
<td></td>
<td></td>
<td>1</td>
<td>1</td>
<td style="text-align: center;"><strong>1</strong></td>
</tr>
<tr class="odd">
<td>p<span class="math inline">\(_3\)</span></td>
<td></td>
<td></td>
<td></td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td style="text-align: center;"><strong>1</strong></td>
</tr>
</tbody>
</table>
<div class="center-container">
<p>S’ha alterat el bit 7 corresponent a d<span class="math inline">\(_4\)</span>.</p>
</div>
</section>
<section id="comprovació-derrors-amb-hamming-0100110" class="slide level2 smaller">
<h2>Comprovació d’errors amb Hamming [0100110]</h2>
<table class="caption-top">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>p<span class="math inline">\(_1\)</span></td>
<td>p<span class="math inline">\(_2\)</span></td>
<td>d<span class="math inline">\(_1\)</span></td>
<td>p<span class="math inline">\(_3\)</span></td>
<td>d<span class="math inline">\(_2\)</span></td>
<td>d<span class="math inline">\(_3\)</span></td>
<td>d<span class="math inline">\(_4\)</span></td>
<td style="text-align: center;">Comprovació</td>
</tr>
<tr class="even">
<td>Codi</td>
<td><strong>0</strong></td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td>p<span class="math inline">\(_1\)</span></td>
<td>0</td>
<td></td>
<td>0</td>
<td></td>
<td>1</td>
<td></td>
<td>0</td>
<td style="text-align: center;"><strong>1</strong></td>
</tr>
<tr class="even">
<td>p<span class="math inline">\(_2\)</span></td>
<td></td>
<td>1</td>
<td>0</td>
<td></td>
<td></td>
<td>1</td>
<td>0</td>
<td style="text-align: center;"><strong>0</strong></td>
</tr>
<tr class="odd">
<td>p<span class="math inline">\(_3\)</span></td>
<td></td>
<td></td>
<td></td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td style="text-align: center;"><strong>0</strong></td>
</tr>
</tbody>
</table>
<div class="center-container">
<p>Els bits de <strong>comprovació = 001</strong> → s’ha alterat el bit 1 corresponent a <span class="math inline">\(p_1\)</span>.</p>
</div>
</section>
<section id="raid-3-i-4" class="slide level2 smaller">
<h2>RAID 3 i 4</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="../figs/slides/03-raids/RAID4.png"></p>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><strong>RAID 3</strong>: striping a nivell de <em>byte</em>, paritat en disc dedicat; accés molt sincronitzat → bo per fitxers grans i seqüencials (p.ex. streaming).</li>
<li class="fragment"><strong>RAID 4</strong>: striping a nivell de <em>bloc</em>, paritat en disc dedicat; permet accessos independents per bloc però pateix bottleneck al disc de paritat.</li>
<li class="fragment">En ambdós casos la paritat dedicada pot ser coll d’ampolla per escriptura.</li>
</ul>
</div></div>
<aside class="notes">
<ul>
<li>La diferència entre un RAID 3 i 4 és la granularitat de la paritat. En un RAID 3 la paritat es calcula a nivell de bytes i en un RAID 4 a nivell de blocs.</li>
<li>Les dades es distribueixen com un RAID 0 i la paritat es guarda en un disc dedicat.</li>
<li>En realitat, en un RAID 3 o 4, les dades no es dupliquen, sinó que es calcula una paritat. Si un disc falla, les dades es poden recuperar utilitzant la informació de paritat dels altres discs.</li>
<li>La figura il·lustra un exemple de configuració RAID 4. En aquest exemple, el RAID 4, identificat com a /dev/md0, està format per cinc discos: /dev/vda, /dev/vdb, /dev/vdc, /dev/vdd i /dev/vde. En aques- ta configuració RAID 4, els primers quatre discos (/dev/vda, /dev/vdb, /dev/vdc, i /dev/vdd) s’utilitzen per emmagatzemar les dades. El cin- què disc (/dev/vde) s’utilitza exclusivament per a la paritat.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="raid-5" class="slide level2 smaller">
<h2>RAID 5</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="../figs/slides/03-raids/RAID5.png"></p>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment">Paritat distribuïda entre tots els discos (evita coll d’ampolla únic).</li>
<li class="fragment"><strong>Tolerància</strong>: 1 disc (<em>hi ha un petit risc durant <code>rebuild</code></em>). Probabilitat de fallada en discs grans.</li>
<li class="fragment"><strong>Lectura</strong>: alta (com RAID0).</li>
<li class="fragment"><strong>Escriptura</strong>: penalització per read-modify-write (llegir bloc antic, llegir paritat antiga, escriure dades i paritat nova) — crític per a càrregues amb moltes escriptures petites.</li>
<li class="fragment"><strong>Capacitat</strong>: <span class="math inline">\((n-1)/n\)</span>.</li>
<li class="fragment"><strong>Aplicacions</strong>: sistemes de fitxers, bases de dades, servidors web.</li>
</ul>
</div></div>
<aside class="notes">
<ul>
<li>El RAID 5 és un dels nivells de RAID més utilitzats en els sistemes informàtics actuals. Aquest RAID ofereix un bon equilibri entre rendiment i redundància.</li>
<li>La principal diferència entre un RAID 4 i un RAID 5 és que en un RAID 5 la paritat es distribueix entre els diferents discs per evitar el coll d’ampolla.</li>
<li>La figura il·lustra un exemple de configuració RAID 5. En aquesta configuració, la paritat es distribueix entre tots els discs, en lloc de ser emmagatzemada en un disc dedicat com en el RAID 4.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="raid-6" class="slide level2 smaller">
<h2>RAID 6</h2>
<ul>
<li class="fragment">Extensió de RAID5 amb doble paritat (P i Q) → tolera 2 fallades simultànies.</li>
<li class="fragment">Recomanat en conjunts grans (n gran) on la probabilitat de fallada durant rebuild és significativa.</li>
<li class="fragment">Penalització d’escriptura més elevada que RAID5, però millor tolerància.</li>
</ul>
</section>
<section id="raid-10" class="slide level2 smaller">
<h2>RAID 10</h2>
<div class="center-container">
<p><strong>mirror + stripe</strong>. Tolerància variable segons quins discs fallen; reconstrucció molt més ràpida.</p>
</div>

<img data-src="../figs/slides/03-raids/RAID10.png" class="r-stretch"></section>
<section id="raid-50" class="slide level2 smaller">
<h2>RAID 50</h2>
<div class="center-container">
<p><strong>Stripe</strong> sobre múltiples conjunts <em>RAID5</em>. Millora rendiment i tolerància depenent de cada grup.</p>
</div>

<img data-src="../figs/slides/03-raids/RAID50.png" class="r-stretch quarto-figure-center"><p class="caption">.</p></section>
<section id="comparativa-de-raids" class="slide level2 smaller">
<h2>Comparativa de RAIDs</h2>
<table class="caption-top">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Nivell</th>
<th>Min discs</th>
<th>Capacitat</th>
<th>Tolerància</th>
<th>Lectura</th>
<th>Escriptura</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>RAID 0</td>
<td>2</td>
<td>100%</td>
<td>0</td>
<td>Alt</td>
<td>Alt</td>
</tr>
<tr class="even">
<td>RAID 1</td>
<td>2</td>
<td>50% (amb 2 discos)</td>
<td>1 per mirror</td>
<td>Pot ser Alt</td>
<td>Mitjà</td>
</tr>
<tr class="odd">
<td>RAID 5</td>
<td>3</td>
<td><span class="math inline">\((n-1)/n\)</span></td>
<td>1</td>
<td>Alt</td>
<td>Mitjà-Baix</td>
</tr>
<tr class="even">
<td>RAID 6</td>
<td>4</td>
<td><span class="math inline">\((n-2)/n\)</span></td>
<td>2</td>
<td>Alt</td>
<td>Mitjà-Baix (pitjor que RAID5)</td>
</tr>
<tr class="odd">
<td>RAID 10</td>
<td>4</td>
<td>50% (depèn)</td>
<td>≥1 (segons fallades)</td>
<td>Alt</td>
<td>Alt</td>
</tr>
<tr class="even">
<td>RAID 50</td>
<td>6</td>
<td>aproximadament <span class="math inline">\((n-1)/n\)</span> per grup</td>
<td>≥1 per grup</td>
<td>Alt</td>
<td>Mitjà</td>
</tr>
</tbody>
</table>
<aside class="notes">
<ul>
<li>La taula mostra una comparativa entre els diferents nivells de RAID més comuns. Aquesta comparativa inclou les característiques més importants de cada RAID, com ara el nombre mínim de dispositius, la redundància, el rendiment en lectura i escriptura i la capacitat.</li>
<li>Com es pot observar, cada RAID té les seves pròpies característiques i avantatges. Per exemple, el RAID 0 ofereix un rendiment molt alt en lectura i escriptura, però no ofereix cap tipus de redundància. En canvi, el RAID 1 ofereix una alta redundància, però el rendiment en escriptura és baix.</li>
<li>Per exemple, la instal·lació d’un sistema operatiu es podria fer en un RAID 1, ja que la redundància és més important que el rendiment.</li>
<li>En canvi, un servidor web seria més adequat en un RAID 5, ja que ofereix un bon equilibri entre rendiment i redundància.</li>
<li>En general, la selecció del RAID més adequat depèn de les necessitats del sistema i dels usuaris.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="raids-a-linux" class="title-slide slide level1 center">
<h1>RAIDs a Linux</h1>

</section>
<section id="dispositiu-devmd" class="slide level2 smaller">
<h2>Dispositiu <code>/dev/md*</code></h2>
<ul>
<li class="fragment">Linux implementa Software RAID mitjançant el subsistema del kernel MD (Multiple Device).</li>
<li class="fragment">El mòdul principal és <code>md_mod</code>, que crea dispositius virtuals de bloc <code>/dev/mdX</code> sobre dispositius físics (<code>/dev/sd*</code>, <code>/dev/nvme*</code>, etc.).</li>
<li class="fragment">Cada dispositiu MD és gestionat per un controlador de tipus <code>mdX</code> que manté una taula de mapatge (metadata) amb:
<ul>
<li class="fragment">nivell RAID (<code>level</code>)</li>
<li class="fragment">nombre de dispositius (<code>raid_disks</code>)</li>
<li class="fragment">superblocs (<code>superblock</code>)</li>
<li class="fragment">estat de sincronització i fallades</li>
</ul></li>
</ul>
</section>
<section id="components-del-subsistema-md" class="slide level2 smaller">
<h2>Components del subsistema MD</h2>
<table class="caption-top">
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>Component</th>
<th>Funció principal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>md_mod</strong></td>
<td>Gestor principal del subsistema MD (creació i manteniment de /dev/mdX).</td>
</tr>
<tr class="even">
<td><strong>raid0, raid1, raid5, raid6, raid10</strong></td>
<td>Mòduls del kernel que implementen la lògica específica de cada nivell RAID.</td>
</tr>
<tr class="odd">
<td><strong>mdadm</strong></td>
<td>Eina <em>user-space</em> que interactua amb el subsistema MD via <code>ioctl</code> i <code>sysfs</code>.</td>
</tr>
<tr class="even">
<td><strong>/proc/mdstat</strong></td>
<td>Punt d’entrada per consultar estat de sincronització, reconstrucció i fallades.</td>
</tr>
<tr class="odd">
<td><strong>/sys/block/mdX</strong></td>
<td>Directori amb informació detallada i opcions de configuració per a cada mdX.</td>
</tr>
</tbody>
</table>
</section>
<section id="flux-doperacions" class="slide level2 smaller">
<h2>Flux d’operacions</h2>
<div class="cell" data-reveal="true" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">sequenceDiagram
    participant A as Aplicació
    participant B as Sistema de fitxers
    participant C as VFS
    participant D as /dev/mdX (md_mod)
    participant E as Driver RAIDn
    participant F as Discos físics

    A-&gt;&gt;B: Read/Write
    B-&gt;&gt;C: Operació de fitxer
    C-&gt;&gt;D: Accés a /dev/mdX
    D-&gt;&gt;E: Gestió RAID
    E-&gt;&gt;F: Accés a discos físics
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li class="fragment">Les operacions de <em>paritat, mirroring o striping</em> s’executen al context del kernel, sovint amb tasques asíncrones (<code>mdX_raid_thread</code>).</li>
<li class="fragment">Les metadades del RAID s’emmagatzemen al final (o inici) de cada disc com a superblock <em>MD v1.x</em>.</li>
<li class="fragment">Des del kernel 4.0 es pot utilitzar <strong>reshape</strong> per canviar el nivell RAID o afegir dispositius en viu.</li>
</ul>
</section>
<section id="paquet-mdadm" class="slide level2 smaller">
<h2>Paquet <code>mdadm</code></h2>
<p>En la majoria de les distribucions de Linux, el paquet <code>mdadm</code> permet la creació i gestió de dispositius RAID.</p>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="distribucions-basades-en-red-hat">Distribucions basades en Red Hat</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a></a><span class="ex">dnf</span> search mdadm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a></a><span class="ex">dnf</span> install mdadm <span class="at">-y</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column" style="width:50%;">
<h3 id="distribucions-basades-en-debian">Distribucions basades en Debian</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a></a><span class="ex">apt</span> search mdadm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a></a><span class="ex">apt</span> install mdadm <span class="at">-y</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></div>
<div class="center">
<p>El funcionament del paquet <code>mdadm</code> és similar en totes les distribucions de Linux. Per tant, les instruccions d’ús són similars i no importa la distribució que s’utilitzeu.</p>
</div>
</section>
<section id="creació-de-dispositius-raids" class="slide level2 smaller">
<h2>Creació de Dispositius RAIDs</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 class="smaller" id="opcions-bàsiques">Opcions Bàsiques</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a></a><span class="ex">mdadm</span> <span class="at">--create</span> <span class="at">--verbose</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span> </span>
<span id="cb5-2"><a></a><span class="ex">--level=[nivell]</span> </span>
<span id="cb5-3"><a></a><span class="ex">--raid-devices=[nº</span> dispositius] <span class="pp">[</span><span class="ss">dispositius</span><span class="pp">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li class="fragment"><strong><code>--create</code></strong>: Crea un nou dispositiu RAID.</li>
<li class="fragment"><strong><code>--verbose</code></strong>: Mostra informació detallada sobre el procés.</li>
<li class="fragment"><strong><code>/dev/[nom]</code></strong>: Nom del dispositiu RAID.</li>
<li class="fragment"><strong><code>--level=[nivell]</code></strong>: RAID.</li>
<li class="fragment"><strong><code>--raid-devices=[nº dispositius]</code></strong>: Nombre de dispositius que formen el RAID.</li>
<li class="fragment"><strong><code>[dispositius]</code></strong>: Llista de dispositius que formen el RAID.</li>
</ul>
<div class="column" style="width:5%;">

</div></div><div class="column" style="width:45%;">
<h3 id="altres-opcions">Altres Opcions</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a></a><span class="ex">mdadm</span> <span class="at">--create</span> <span class="at">--help</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li class="fragment"><strong><code>--metadata=[tipus]</code></strong>: Tipus de metadades.</li>
<li class="fragment"><strong><code>--spare-devices=[nº dispositius]</code></strong>: Nombre de dispositius reservats.</li>
<li class="fragment"><strong><code>--chunk=[mida]</code></strong>: Mida dels blocs.</li>
<li class="fragment"><strong><code>--layout=[esquema]</code></strong>: Esquema de distribució de les dades.</li>
</ul>
</div></div>
</section>
<section id="gestió-del-raid---manage" class="slide level2 smaller">
<h2>Gestió del RAID <code>(--manage)</code></h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a></a><span class="ex">mdadm</span> <span class="at">--manage</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">options</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">dispositius</span><span class="pp">]</span></span>
<span id="cb7-2"><a></a>  <span class="ex">--add</span>         <span class="at">-a</span>   : afegeix dispositius posteriors a l<span class="st">'array</span></span>
<span id="cb7-3"><a></a><span class="st">  --re-add           : els dispositius posteriors són reafegits si eren</span></span>
<span id="cb7-4"><a></a><span class="st">                     : membres recents de l'</span>array</span>
<span id="cb7-5"><a></a>  <span class="ex">--remove</span>      <span class="at">-r</span>   : elimina els dispositius posteriors, que no han d<span class="st">'estar actius</span></span>
<span id="cb7-6"><a></a><span class="st">  --fail        -f   : marca els dispositius posteriors com a defectuosos</span></span>
<span id="cb7-7"><a></a><span class="st">  --set-faulty       : igual que --fail</span></span>
<span id="cb7-8"><a></a><span class="st">  --replace          : marca el(s) dispositiu(s) per ser reemplaçat(s) per recanvis. </span></span>
<span id="cb7-9"><a></a><span class="st">                     : Un cop completat el reemplaçament, el dispositiu es marcarà </span></span>
<span id="cb7-10"><a></a><span class="st">                     : com a defectuós</span></span>
<span id="cb7-11"><a></a><span class="st">  --with             : indica quin recanvi hauria de preferir un '</span>--replace<span class="st">' anterior</span></span>
<span id="cb7-12"><a></a><span class="st">  --run         -R   : inicia un array parcialment construït</span></span>
<span id="cb7-13"><a></a><span class="st">  --stop        -S   : desactiva l'</span>array, alliberant tots els recursos</span>
<span id="cb7-14"><a></a>  <span class="ex">--readonly</span>    <span class="at">-o</span>   : marca l<span class="st">'array com a només lectura</span></span>
<span id="cb7-15"><a></a><span class="st">  --readwrite   -w   : marca l'</span>array com a lectura i escriptura</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="informació-i-monitoratge-del-raid" class="slide level2 smaller">
<h2>Informació i Monitoratge del RAID</h2>
<p>Les opcions <code>--detail</code> i <code>--examine</code> permeten obtenir informació detallada sobre un dispositiu RAID. La principal diferència entre ambdues opcions és que <code>--examine</code> mostra informació més detallada sobre el dispositiu.</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a></a><span class="ex">mdadm</span> <span class="at">--detail</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column" style="width:50%;">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a></a><span class="ex">mdadm</span> <span class="at">--examine</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></div>
<p>La opció <code>--monitor</code> permet monitorar un dispositiu RAID en temps real. Obtenint informació sobre els esdeveniments que es produeixen en el dispositiu i ens permet prendre accions en conseqüència.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a></a><span class="ex">mdadm</span> <span class="at">--monitor</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="ensamblatge---assemble" class="slide level2">
<h2>Ensamblatge <code>--assemble</code></h2>
<ul>
<li class="fragment">Permet muntar un array RAID existent.</li>
<li class="fragment">Aquesta opció no crea un nou array, sinó que reuneix un array existent a partir dels dispositius que especifiquem.</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a></a><span class="ex">mdadm</span> <span class="at">--assemble</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">dispositius</span><span class="pp">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li class="fragment">Cada cop que el sistema s’inicia, aquesta opció s’executa al kernel. Escaneja els discs, busca els superblocks i reconstrueix tots els arrays per a nosaltres.</li>
</ul>
</section>
<section id="initramfs-i-raid" class="slide level2 smaller">
<h2>Initramfs i RAID</h2>
<p>En entorns amb RAID, <strong>initramfs</strong> inclou els binaris i la configuració necessaris per gestionar els arrays RAID. Durant la fase d’arrencada, es fa servir la comanda:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a></a><span class="ex">mdadm</span> <span class="at">--assemble</span> <span class="at">--scan</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Detecta i munta automàticament tots els arrays definits a <code>/etc/mdadm/mdadm.conf</code>. Això assegura que les particions RAID estiguin operatives abans de muntar la partició root i iniciar el sistema operatiu.</p>
<p>A més, initramfs pot incloure scripts per comprovar la integritat dels dispositius RAID i gestionar fallades de discs durant l’arrencada, assegurant un boot fiable en entorns amb mirroring (RAID1).</p>
</section>
<section id="actualització-amb---grow" class="slide level2 smaller">
<h2>Actualització amb <code>--grow</code></h2>
<p>Aquesta opció permet actualitzar un dispositiu RAID. Per exemple, canviar el RAID, augmentar el nombre de dispositius o canviar la mida dels blocs.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a></a><span class="ex">mdadm</span> <span class="at">--grow</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span> <span class="at">--level</span><span class="op">=</span><span class="pp">[</span><span class="ss">nivell</span><span class="pp">]</span> <span class="at">--raid-devices</span><span class="op">=</span>[nº dispositius]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li class="fragment"><strong>Situació I</strong>: En un RAID5 format per 3 discs, ens pot interessar al cap del temps afegir un disc més.</li>
<li class="fragment"><strong>Situació II</strong>: En un RAID5 format per 4 discs, ens pot interessar al cap del temps canviar el RAID a 6.</li>
<li class="fragment"><strong>Situació III</strong>: En un RAID5 format per 4 discs, ens pot interessar al cap del temps canviar la mida dels blocs.</li>
</ul>
<div title="Compte!">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Compte!</strong></p>
</div>
<div class="callout-content">
<p>Amb aquestes operacions, el sistema pot quedar inutilitzat. És recomanable fer una còpia de seguretat abans de realitzar aquestes operacions.</p>
</div>
</div>
</div>
</div>
</section>
<section id="aturar-i-eliminar-un-raid" class="slide level2 smaller">
<h2>Aturar i Eliminar un RAID</h2>
<p>Per aturar un RAID, podem utilitzar l’opció <code>--stop</code> del mode <code>--manage</code> de <code>mdadm</code>. Aquesta opció desactiva l’array i allibera tots els recursos associats.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a></a><span class="ex">mdadm</span> <span class="at">--manage</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span> <span class="at">--stop</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div title="Compte!">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Compte!</strong></p>
</div>
<div class="callout-content">
<p>Aquesta operació no <strong>destruirà</strong> l’array, sinó que simplement el desactivarà. Per eliminar un raid podem eliminar el seu dispositiu associat, sempre primer aturant l’array.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a></a><span class="ex">mdadm</span> <span class="at">--manage</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span> <span class="at">--stop</span></span>
<span id="cb15-2"><a></a><span class="fu">rm</span> /dev/<span class="pp">[</span><span class="ss">nom</span><span class="pp">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="etcmdadmmdadm.conf" class="slide level2 smaller">
<h2><code>/etc/mdadm/mdadm.conf</code></h2>
<p>Aquest fitxer conté informació que permet al sistema reconèixer i muntar automàticament els arrays RAID durant l’arrencada i també proporciona paràmetres per a la creació, monitorització i manteniment dels arrays.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode numberSource text number-lines code-with-copy"><code class="sourceCode"><span id="cb16-1"><a></a>ARRAY /dev/md0 UUID=12345678:90ab:cdef:1234:567890abcdef</span>
<span id="cb16-2"><a></a>ARRAY /dev/md1 UUID=abcdef12:3456:7890:abcd:ef1234567890</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li class="fragment"><code>ARRAY</code>: indica un dispositiu RAID gestionat per mdadm.</li>
<li class="fragment"><code>/dev/mdX</code>: dispositiu de bloc que representa l’array RAID.</li>
<li class="fragment"><code>UUID</code>: identificador únic de l’array RAID, utilitzat per assegurar que el sistema connecta correctament les particions corresponents encara que canviïn els noms dels dispositius físics (per exemple, vdb1 esdevé vdc1).</li>
</ul>
</section></section>
<section>
<section id="casos-pràctics" class="title-slide slide level1 center">
<h1>Casos Pràctics</h1>
<ul>
<li class="fragment"><p>El <strong>RAID 0</strong> ofereix una major velocitat de lectura i escriptura, però no proporciona cap mena de redundància. Una fallada en un disc faria que es perdessin totes les dades. Per tant, no és una bona opció per a un sistema root.</p></li>
<li class="fragment"><p>El <strong>RAID 1</strong> ofereix redundància. No obstant això, no millora la velocitat d’escriptura. Aquest RAID és una bona opció per a un sistema root, ja que assegura la integritat de les dades.</p></li>
</ul>
</section>
<section id="cas-pràctic-i" class="slide level2 smaller">
<h2>Cas Pràctic (I)</h2>
<p>Assumeix que vols configurar un RAID per configurar la partició <em>root</em> del teu servidor Debian. <em>quin RAID recomanaries i que t’aportaria?</em></p>
<ul>
<li class="fragment"><p>El <strong>RAID 5</strong>. Aquest RAID ofereix redundància i una millora en la velocitat de lectura. No obstant això, requereix un mínim de tres discs i la velocitat d’escriptura pot veure’s afectada per les operacions de paritat. Aquest RAID pot ser una bona opció per a emmagatzemament de dades, però pot ser massa complex per a un sistema root.</p></li>
<li class="fragment"><p><strong>El RAID 10</strong> combina les característiques del RAID 1 i del RAID 0, oferint tant redundància com una millora en la velocitat de lectura i escriptura. Aquest RAID pot ser una bona opció per a un sistema que requereixi un alt rendiment, però pot ser massa costós per a un sistema root.</p></li>
</ul>
<aside class="notes">
<ul>
<li>La meva recomanació és utilitzar <strong>RAID 1</strong> per a un sistema <em>root</em>, ja que proporciona la redundància necessària per assegurar la integritat de les dades del sistema. Si la velocitat de lectura és una preocupació, es podria considerar l’ús d’un disc SSD</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="cas-pràctic-ii" class="slide level2 smaller">
<h2>Cas Pràctic (II)</h2>
<p>Assumeix que vols configurar un servidor amb dos discs SATA per fer renders de vídeo on l’objectiu principal es millorar el rendiment i la capacitat d’enmagatzemament temporal. <em>Quin RAID recomanaries?</em></p>
<ul>
<li class="fragment">Com únicament es disposa de dos discs, el <strong>RAID 0</strong> seria la millor opció. Aquest RAID millora el rendiment i la capacitat d’emmagatzemament temporal, ja que les dades es divideixen i s’emmagatzemen en els dos discs de forma simultània. No obstant això, cal tenir en compte que el RAID 0 no ofereix cap mena de redundància. Per tant, si un dels discs falla, es perdran totes les dades. S’haurien de fer còpies de seguretat regulars per evitar la pèrdua de dades.</li>
</ul>
</section>
<section id="cas-pràctic-iii" class="slide level2 smaller">
<h2>Cas Pràctic (III)</h2>
<p>Assumeix un servidor de bases de dades on la integritat de les dades es crítica i les transaccions han de ser ràpides. <em>Quin RAID recomanaries?</em></p>
<ul>
<li class="fragment">En aquest cas, el <strong>RAID 10</strong> seria la millor opció. Aquest RAID combina les característiques del RAID 1 i del RAID 0, oferint tant redundància com una millora en la velocitat de lectura i escriptura. Això és important per a un servidor de bases de dades on la integritat de les dades és crítica i les transaccions han de ser ràpides.</li>
</ul>
</section>
<section id="exercici" class="slide level2 smaller">
<h2>Exercici</h2>
<ol type="1">
<li class="fragment">Configuració d’un RAID 1 a AlmaLinux amb una instal·lació neta.</li>
<li class="fragment">Migració de <code>/home</code> a un RAID 1 en un sistema Debian existent.</li>
<li class="fragment">Simulació de fallada d’un disc en un RAID 5.</li>
<li class="fragment">Migració d’un sistema <code>legacy</code> a un sistema amb RAIDs.</li>
</ol>
<div class="center-container">
<p><a href="../exercises/03-fs/09-ex-week6.html">Exercicis: Administrant RAIDs</a></p>
</div>
</section>
<section id="thats-all" class="slide level2">
<h2>That’s all</h2>
<div class="columns">
<div class="column" style="width:45%;">
<div title="Take Home Message">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Take Home Message</strong></p>
</div>
<div class="callout-content">
<ul>
<li class="fragment">RAID manté les dades, però la bona administració manté el servei.</li>
<li class="fragment">La redundància no és seguretat si no s’ha provat mai l’arrencada.</li>
<li class="fragment">Configurar RAID és fàcil; garantir que arrenca quan els discs fallen és el camí de l’administrador.</li>
<li class="fragment">RAID no és substitut de les còpies de seguretat.</li>
</ul>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column" style="width:50%;">
<p><img data-src="https://static.posters.cz/image/750/posters/looney-tunes-thats-all-folks-i295.jpg" style="width:70.0%"></p>
</div></div>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../figs/corporative/institute.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Unitat 3 · Administració i Manteniment de Sistemes i Aplicacions (AMSA) <a href="../index.html">🏠</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/amsa-gei-udl-2526-105013\.github\.io\/course\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>